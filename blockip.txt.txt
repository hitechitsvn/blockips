/system logging action add name=syslog target=remote remote=192.168.1.200 remote-port=514
/system logging add topics=firewall action=syslog
/system logging add topics=info action=syslog
/system logging add topics=error action=syslog
/system logging add topics=warning action=syslog
/system logging add topics=critical action=syslog
/system logging add topics=account action=syslog

/system logging remove [find action=memory]
/system logging remove [find action=echo]

/system logging disable [find action=memory]
/system logging disable [find action=echo]


import re
log_file = '/volume1/logs/syslog.log'
output_file = '/volume1/logs/blockip.txt'
with open(log_file, 'r') as f:
    log = f.read()
    # Tìm IP từ log
    login_ips = re.findall(r'login failure.*?from (\d+\.\d+\.\d+\.\d+)', log)
    attack_ips = re.findall(r'ATTACK:.*?(\d+\.\d+\.\d+\.\d+)', log)
    all_ips = set(login_ips + attack_ips)
    with open(output_file, 'w') as out:
        out.write('\n'.join(all_ips))